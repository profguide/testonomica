V2 писалась для интеграции с сайтом ставропольского колледжа.

Вот что изменилось по сравнению с предыдущими версиями.

- вводится регистрация пользователя (нужен id), взамен мы даём постоянный USER_TOKEN.
- введены политики (политика регистрации пользователей и политика сохранения результатов).
- происходит списание доступов (можно в минус, если политика работы с клиентским сайтом позволяет это)
- происходит учёт результатов пользователя ManyToMany (здесь могут быть введены ограничения в соостветствии с
  политикой работы с клиентским сайтом)

---

Вот как это выглядит на схеме.

1. Клиентский сайт регистрируется в нашей системе и получает постоянный секретный токен сайта PARTNER_TOKEN.

2. Клиенсткий сайт получает постоянный ключ пользователя (USER_TOKEN) через процедуру регистрации пользователя по API.
   (нам требуется только ID пользователя и PARTNER_TOKEN). Если пользователь уже есть, просто возвращаем токен без
   создания.
   При этом происходит списание количества доступов для клиентского сайта.
   Это всё регулируется политикой работы с клиентсим сайтом - "предоплатная" или "постоплатная".
   Если предоплата, то следим, чтобы доступы были больше нуля.
   Если постоплата, то списываем без проверок (можно в минус).

3. Перед показом теста клиентский сайт запрашивает одноразовый токен ACCESS_TOKEN (как сейчас).
   Надо только удалять старые токены. Допустим, срок жизни токена - 24 часа.

4. Когда вопросник пройден, клиентской сайт передаёт нам по API USER_TOKEN и ответы, чтобы сохранить результаты и
   получить ключ результата. Здесь мы сверяемся с другой политикой - политикой сохранения результатов. Так мы проверям
   ответы на какие тесты этот пользователь уже сохранил. Если ещё не сохранил, то мы позволяем ему это сделать. Политика
   предоставления доступов для различных сайтов может быть разная. Одним мы можем предоставлять по одному доступу только
   один тест, другому два разных теста. Третьему сайту разрешено сохранять более одного результата одного теста для
   одного пользователя.

Эта схема так же хороша, потому что позволит проверять USER_TOKEN по API - какие тесты пройдены, какие
доступны, и сколько есть доступов и список USER_TOKEN, их результаты.

----

Пишу документацию:

# API Documentation

## Регистрация пользователя

Регистрирует пользователя на Тестодроме и увеличивает счётчик выданных доступов на один. Повторно пользователь не
создаётся и счётик не увеличивается.

**URL**: `GET /partner/api/v2/user/register`

### Параметры:

- `client` (обязательный): Секретный постоянный токен вашего сайта, который вы получили при регистрации вашего сайта.
  Этот параметр должен быть строкой.
- `user_id` (обязательный): уникальный идентификатор пользователя в вашей системе, например, id или email. Этот параметр
  должен быть строкой.

### Результат:

- **Код состояния:** 200 ОК
- **Пример успешного ответа:**

```json
{
  "user_id": "92f50432-dd78-4f57-b407-6bb273c78f62"
}
```

### Возможные ошибки:

- Не указаны обязательные параметры.
- Клиент не найден по указанному токену.
- Достигнут предел выданных доступов.

**Пример ошибки:**

```json
{
  "error": {
    "code": 404,
    "message": "Client not found with the provided token."
  }
}
```