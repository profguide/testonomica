{#{% extends('tests/result.html.twig') %}#}

{% block result %}
    {% set debug = app.request.get('debug') == 1 ? 1 : 0 %}
    <style>
        h1, h2, h3 {
            text-align: center;
        }

        h1 {
            margin: 10px 0;
        }

        #testonomica_header {
            display: none;
        }

        .profession {

        }

        .profession__img {
            width: 150px;
            min-width: 150px;
            height: 100px;
            background-size: cover;
        }

        .profession__img_no-pic {
            background-image: url('/images/sys/nopic.png')
        }

        .type {
        }

        .type__header {
        }

        .type__level {
        }

        .type__level-high {
            font-weight: 600;
        }

        .type__level-middle {
        }

        .type__level-low {
            font-weight: 200;
        }

        .type__description {
        }
    </style>
    <div class="container">
        <h1>Результат тестирования</h1>
        <div>
            <p>Полученные результаты основаны на принципах, которые разрабатывались в Профгиде в течение 15 лет
                практикующими специалистами по выбору профессии. В исследовании принимали участие 10 000 человек.</p>
        </div>
        <h3>Профессии</h3>
        <ol>
            {% for profession in professions %}
                <li style="margin-bottom: 15px">
                    <div style="position: relative">
                        {% if debug == 1 %}
                            <span style="position: absolute; font-size: small; right: 0">{{ profession.rating }}</span>
                        {% endif %}
                        {% if profession.description|length == 0 %}
                            <div>{{ profession.name }}</div>
                        {% elseif profession.description|length > 1 %}
                            <div><b>{{ profession.name }}</b></div>
                            {# <div>Называется так-то, есть несколько разновидностей, краткий очерк и ниже примеры:</div> #}
                        {% endif %}
                        {% for kind in profession.description %}
                            <div>
                                {% if profession.description|length > 0 %}
                                    {% if kind.link is defined %}
                                        <div><a href="{{ kind.link }}" target="_blank">{{ kind.name }}</a></div>
                                    {% else %}
                                        <div>{{ kind.name }}</div>
                                    {% endif %}
                                {% endif %}
                                <div style="display: flex">
                                    {% if kind.pic is defined %}
                                        <div class="profession__img"
                                             style="background-image: url({{ kind.pic }})"></div>
                                    {% else %}
                                        <div class="profession__img profession__img_no-pic"></div>
                                    {% endif %}
                                    <p style="margin-left: 20px;">{{ kind.text }}</p>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </li>
            {% endfor %}
        </ol>
    </div>

    <div class="container mt-4">
        <div class="mb-4">
            <h2>Интересы</h2>
            <p>Ваши интересы выражаются в том, что именно вы читаете, смотрите, любите делать и делаете.</p>
            {% for typeName, data in types_descriptions.interest %}
                <div class="type">
                    <div class="type__header">
                        <b>{{ data.name }}</b>
                        <span class="type__level">
                            {% if data.level.absolute == 2 %}
                                <span class="type__level-high">(высокое значение)</span>{% endif %}
                            {% if data.level.absolute == 1 %}
                                <span class="type__level-middle">(среднее значение)</span>{% endif %}
                            {% if data.level.absolute == 0 %}
                                <span class="type__level-low">(низкое значение)</span>{% endif %}
                        </span>
                    </div>
                    <p class="type__description">{{ data.text }}</p>
                </div>
            {% endfor %}
        </div>

        <div class="mb-4">
            <h2>Способности</h2>
            <p>Ваши способности в выражаются в том, что вы делаете хорошо и успешно, но еще не профессионально, уже
                сейчас.</p>
            {% for typeName, data in types_descriptions.skills %}
                <div class="type">
                    <div class="type__header">
                        <b>{{ data.name }}</b>
                        <span class="type__level">
                            {% if data.level.absolute == 2 %}
                                <span class="type__level-high">(высокий показатель)</span>{% endif %}
                            {% if data.level.absolute == 1 %}
                                <span class="type__level-middle">(средний показатель)</span>{% endif %}
                            {% if data.level.absolute == 0 %}
                                <span class="type__level-low">(низкий показатель)</span>{% endif %}
                        </span>
                    </div>
                    <p class="type__description">{{ data.text }}</p>
                </div>
            {% endfor %}
        </div>
    </div>

    <div class="container">
        <h2>Вторая часть теста</h2>
        <p class="text-center"><a href="/tests/view/personality-intelligence/" class="btn btn-primary">Личность и
                структура интеллекта</a></p>
    </div>

    {% if debug == 1 %}
        <section class="bg-light mb-2 mt-2 pt-4 pb-4">
            <div class="container">
                <h3 class="bg-info text-white" style="text-align: center; ">DEBUG</h3>
                <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
                <div class="card card-body alert-success">
                    <h4>Топовые типы</h4>
                    <ol>
                        {% for name, value in types_top %}
                            <li>{{ name }}: {{ value }}%</li>
                        {% endfor %}
                    </ol>
                </div>
                <div class="card card-body mt-4">
                    <h4>Типы со сгруппированными значениями</h4>
                    <script type="text/javascript">
                        google.charts.load("current", {packages: ['corechart']});
                        google.charts.setOnLoadCallback(drawChart);

                        function drawChart() {
                            var data = google.visualization.arrayToDataTable([
                                ['Тип', 'Значение'],
                                {% for name, value in types_single_percent %}
                                ['{{ name }}', {{ value }}],
                                {% endfor %}
                            ]);
                            var options = {
                                title: "Типы со сгруппированными значениями, в %",
                                width: '100%',
                                height: 600,
                                bar: {groupWidth: '80%'},
                                legend: {position: 'none'},
                            };
                            var chart = new google.visualization.ColumnChart(document.getElementById('all_types'));
                            chart.draw(data, options);
                        }
                    </script>
                    <ol class="mt-3">
                        {% for name, value in types_single_percent %}
                            <li>{{ name }}: {{ value }}%</li>
                        {% endfor %}
                    </ol>
                    <div id="all_types"></div>
                </div>
                <div class="card card-body mt-4">
                    <h4>Типы и значения по группам</h4>
                    <table class="table">
                        <tr>
                            <th>Тип</th>
                            <th>Усилия</th>
                            <th>Интерес</th>
                            <th>Способности</th>
                        </tr>
                        {% for name, value in types_group_percent %}
                            <tr>
                                <td><b>{{ name }}</b></td>
                                <td>{{ value.0 }}%</td>
                                <td>{{ value.1 }}%</td>
                                <td>{{ value.2 }}%</td>
                            </tr>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </section>
    {% endif %}
{% endblock result %}
{# {% block javascripts %} #}
    {# {{ parent() }} #}
{# {% endblock %}  #}