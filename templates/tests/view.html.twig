{% extends 'base.html.twig' %}

{% block title %}{{ test.name }}{% endblock %}

{% block body %}
    {% if (app.user and 'ROLE_ADMIN' in app.user.roles) %}
        <div style="position: fixed; top: 3rem; right: 60px;">
            <div class="container">
                <a href="{{ path('admin.tests.edit', {id: test.id}) }}" class="btn btn-sm btn-secondary">Изменить</a>
            </div>
        </div>
    {% endif %}
    {% block stylesheets %}
        {{ parent() }}
        {{ encore_entry_link_tags('test') }}
    {% endblock %}
    <section class="tnc-welcome container" id="app-preload-screen">
        <h1 class="tnc-welcome__title">{{ test.name(app.request.locale) }}</h1>
        <div class="tnc-welcome__duration">{{ test.duration }} {% trans %}минут{% endtrans %}</div>
        <div class="tnc-welcome__description">{{ test.description(app.request.locale)|raw }}</div>
        {% if (test.authors|length > 0) %}
            <div class="tnc-welcome__authors">{{ test.authors|length == 1 ? 'Автор теста:'|trans : 'Авторы теста:'|trans }}
                {% for author in test.authors %}{{ author.name(app.request.locale)|raw }}{{ not loop.last ? ', ' }}{{ loop.last ? '.' }}{% endfor %}
            </div>
        {% endif %}
        <div class="tnc-welcome__loading stage"></div>
    </section>
    <style>
        #testonomica_app {
            padding: 0;
        }

        .tnc-welcome {
            position: relative;
        }

        .tnc-welcome__btn {
            background: #5c5fef;
            border-color: #5c5fef;
        }

        .tnc-welcome__btn_restart {
            background: #f8f9fa !important;
            border-color: #f8f9fa !important;
        }
    </style>
    <div id="testonomica_app"
         data-test="{{ test.id }}"
            {#         data-token="SOME_PUBLIC_TOKEN" #}
         data-init="auto"
         data-host="{{ host }}">
    </div>
    {% block javascripts %}
        {{ parent() }}
        {{ encore_entry_script_tags('test') }}
    {% endblock %}
    <script>
        // removes preload screen on App load.
        window.testonomica.addEventListener('loaded', function () {
            document.getElementById('app-preload-screen').remove();
        });
    </script>
{% endblock %}
